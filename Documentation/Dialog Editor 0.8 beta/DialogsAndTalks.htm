<BASE HREF="http://tiger/x-wiki/DialogsAndTalks">
<html><head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=iso-8859-5">
<title>DialogsAndTalks - X-Wiki</title><meta name="KEYWORDS" content="Dialogs, And, Talks">
<link rel="stylesheet" type="text/css" href="/wiki/css/moinmoin.css">
<link rel="Start" href="/x-wiki/FrontPage">
<link rel="Alternate" title="Wiki Markup" href="/x-wiki/DialogsAndTalks?action=raw">
<link rel="Alternate" media="print" title="Print View" href="/x-wiki/DialogsAndTalks?action=print">
<link rel="Search" href="/x-wiki/FindPage">
<link rel="Index" href="/x-wiki/TitleIndex">
<link rel="Glossary" href="/x-wiki/WordIndex">
<link rel="Help" href="/x-wiki/HelpOnFormatting">
</head>
<body onload="window.defaultStatus='X-Wiki'" lang="en" dir="ltr"><a name="top"></a>
<table width="100%"><tr><td>
<a href="/x-wiki/FrontPage"><img src="/wiki/img/moinmoin.gif" border="0" alt="X-Wiki"></a>
</td><td width="99%" valign="middle" class="headline">&nbsp;
<a title="Click here to do a full-text search for this title" href="/x-wiki/DialogsAndTalks?action=fullsearch&value=DialogsAndTalks&literal=1&case=1&context=40">DialogsAndTalks</a>
</td>
<td valign="bottom" align="left" nowrap>
<font face="Verdana" size="1"><a href="/x-wiki/UserPreferences">UserPreferences</a><br>&nbsp;</font>
</td></tr></table>

<a href="/x-wiki/HelpContents" target="_blank" title="HelpContents"><img src="/wiki/img/moin-help.gif" alt="HelpContents" width="12" height="11" border="0" hspace="2" align="right"></a>
<a href="/x-wiki/FindPage?value=DialogsAndTalks" title="FindPage"><img src="/wiki/img/moin-search.gif" alt="FindPage" width="12" height="12" border="0" hspace="2" align="right"></a>
<a href="/x-wiki/DialogsAndTalks?action=diff" title="Diffs"><img src="/wiki/img/moin-diff.gif" alt="Diffs" width="15" height="11" border="0" hspace="2" align="right"></a>
<a href="/x-wiki/DialogsAndTalks?action=info" title="Info"><img src="/wiki/img/moin-info.gif" alt="Info" width="12" height="11" border="0" hspace="2" align="right"></a>
<a href="/x-wiki/DialogsAndTalks?action=edit" title="Edit"><img src="/wiki/img/moin-edit.gif" alt="Edit" width="12" height="12" border="0" hspace="2" align="right"></a>
<a href="/x-wiki/DialogsAndTalks?action=subscribe" title="Subscribe"><img src="/wiki/img/moin-email-x.gif" alt="Subscribe" width="14" height="10" border="0" hspace="2" vspace="1" align="right"></a>
<a href="/x-wiki/DialogsAndTalks?action=format&mimetype=text/xml" title="XML"><img src="/wiki/img/moin-xml.gif" alt="XML" width="20" height="13" border="0" hspace="2" align="right"></a>
<a href="/x-wiki/DialogsAndTalks?action=print" title="Print"><img src="/wiki/img/moin-print.gif" alt="Print" width="16" height="14" border="0" hspace="2" align="right"></a>
<a href="/x-wiki/DialogsAndTalks" title="View"><img src="/wiki/img/moin-show.gif" alt="View" width="12" height="13" border="0" hspace="2" align="right"></a>

<table class="navibar" cellpadding=0 cellspacing=3 border=0><tr><td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<b>X-Wiki</b>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a class="navibar" href="/x-wiki/FrontPage">FrontPage</a>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a class="navibar" href="/x-wiki/RecentChanges">RecentChanges</a>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a class="navibar" href="/x-wiki/TitleIndex">TitleIndex</a>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a class="navibar" href="/x-wiki/WordIndex">WordIndex</a>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a class="navibar" href="/x-wiki/SiteNavigation">SiteNavigation</a>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a target="_blank" class="navibar" href="/x-wiki/HelpContents">HelpContents</a>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a target="_blank" class="navibar" href="http://moin.sf.net/">moin.sf.net</a>&nbsp;</font></td>
</tr></table>
<hr><p><b>Диалоги и общение</b> <p>Общение осуществляется путем связи 2х персонажей специальной структурой - "диалогом". Диалог представляет собой однонаправленный ациклический граф фраз. Фраза представляет собой структуру специального вида: <p><hr>
 <em> &lt;!-- id - уникальный в пределах диалога номер фразы --&gt; <ul><p>      &lt;phrase id="6"&gt; <ul><p>        &lt;!-- текстовое представление фразы --&gt; <p>        &lt;text&gt;Sorry, but I have to go.&lt;/text&gt; <p>        &lt;!-- или скриптовая функция которая возвращает строку текста --&gt; <p>        &lt;script_text&gt;info_test1.test_text&lt;/script_text&gt; <p>        &lt;!-- минимальный уровень благосклонности персонажа, чтоб он смог сказать фразу --&gt; <p>        &lt;goodwill&gt;60&lt;/goodwill&gt; <p>        &lt;!-- cкриптовые предикаты, если они все вернут true то фраза станет доступной --&gt; <p>        &lt;precondition&gt;info_test1.test_action&lt;/action&gt; <p>        &lt;precondition&gt;info_test1.test_action1&lt;/action&gt; <p>        &lt;!-- особые предикаты проверяют наличие/отсутствие  порций информации у того кто говорит фразу --&gt; <p>        &lt;has_info&gt;info_name1&lt;/has_info&gt; <p>        &lt;dont_has_info&gt;info_name1&lt;/dont_has_info&gt; <p>        &lt;!-- cписок тех id фраз которые станут доступны собеседнику после того как будет сказана эта фраза --&gt; <p>        &lt;next&gt;7&lt;/next&gt; <p>        &lt;next&gt;5&lt;/next&gt; <p>        &lt;!-- cкриптовые функции, которые могут быть вызваны --&gt; <p>        &lt;action&gt;info_test1.test_action&lt;/action&gt; <p>        &lt;action&gt;info_test1.test_action1&lt;/action&gt; <p>        &lt;!-- особые функции, которые дают/убирают порции информации тому кто говорит фразу --&gt; <p>        &lt;give_info&gt;info_name1&lt;/give_info&gt; <p>        &lt;disable_info&gt;info_name1&lt;/disable_info&gt; </ul></ul><p>&lt;/phrase&gt;</em> <p><hr>
 <p>У диалога всегда есть одна стартовая фраза (с id="0") и одна или несколько финальных (отсутствуют теги &lt;next&gt;). Персонаж, который начинает диалог всегда говорит стартовую фразу. <p>После того как сказана фраза право говорить переходит к собеседнику. Он выбирает фразу из списка доступных фраз, который представляет собой список тех фраз на которые ссылаются &lt;next&gt; сказанной фразы и для которой скриптовые <em><b>ВСЕ</b></em> функции &lt;precondition&gt; возвращают true. После того как фраза сказана последовательно выполняются все скиптовые действия, имена, которых заданы тегами &lt;action&gt;. <p>Все вызываемые скриптовые функции (как action так и precondition) задаются своим <em><b>ПОЛНЫМ</b></em> именем: NAMESPACE.FUNC_NAME, NAMESPACE - обычно просто имя файла скрипта с функцией. <p>Все скриптовые функции получают на вход 2 параметра: собеседник1 и собеседник2. Эти параметры представляют собой объекты персонажей ведущих диалог (актер, сталкеры, торговцы). Причем первым параметром идет тот, кто говорит фразу. <p>Особой фразой является "пустышка" - фраза в которой отсутствует тег &lt;text&gt;. Фразы - пустышки, полезны, если мы хотим пропустить очередь говорить одного из собеседников. Также с помощью пустышек можно делать стартовые "развилки", то есть нужно сделать возможность начинать диалог не с одной, а со списка различных фраз (в таком случае делается 2 пустышки с id 0 и 1). <p>Диалог заканчивается, когда у сказана фраза у которой нет тегов &lt;next&gt;. Если у теги &lt;next&gt; есть но они все не доступны в силу не выполненых precondition, то это считается ошибкой. <p>Общая структура диалога имеет вид <p>pda="1"/"0"  - аттрибут указывающий на то что диалого будет использоваться исключительно при связи по PDA <p>priority="-1" - целое число (может быть отрицательным), чем меньше число тем ниже диалог появится при выборе из меню актера <p><hr>
 <em> &lt;!-- id - уникальная строка однозначно определяющая каждый диалог --&gt; <ul><p>        &lt;dialog id="test_dialog" pda="1" priority="-1"&gt; <ul><p>                &lt;!-- название диалога, если оно не задано, то в качестве названия будет <ul><p>                     использоваться текст первой фразы. --&gt;      </ul><p>                &lt;caption&gt;Say 'Hello'&lt;/caption&gt; <p>                &lt;!-- cкриптовый предикат активизации диалога --&gt; <p>                &lt;precondition&gt;info_test1.test_predicate&lt;/precondition&gt; <p>                &lt;!-- их может быть несколько --&gt; <p>                &lt;precondition&gt;info_test1.test_predicate2&lt;/precondition&gt; <p>                &lt;!-- предикаты аналогичные таким же во Phrase --&gt; <p>                &lt;has_info&gt;info_name1&lt;/has_info&gt; <p>                &lt;dont_has_info&gt;info_name1&lt;/dont_has_info&gt; <p>                &lt;phrase_list&gt; <ul><p>                      ......список фраз......... </ul><p>                &lt;phrase_list&gt; </ul></ul><ul><p>       &lt;/dialogs&gt;</em> </ul><p><hr>
 <a name="bottom"></a>
<br><br>
<a href="http://www.python.org/"><img align="right" vspace="10" hspace="3"
src="/wiki/img/PythonPowered.gif" width="55" height="22" border="0"
alt="PythonPowered"></a>
<table lang="en" dir="ltr" border="0" cellspacing="0" cellpadding="0" class="footer" width="100%">
<form method="POST" action="/x-wiki/DialogsAndTalks">
<tr><td>
<input type="hidden" name="action" value="inlinesearch">
<input type="hidden" name="context" value="40">

<a href="/x-wiki/DialogsAndTalks?action=edit">EditText</a> of this page&nbsp;&nbsp; [current page size <b>4139</b> bytes]&nbsp;&nbsp; (last edited 2004-09-13 17:08:13 by <span title="10.1.0.131">london.gsc-game.kiev.ua</span>)<br><a href="/x-wiki/FindPage?value=DialogsAndTalks">FindPage</a>
 by browsing, title search <input style="font-family:Verdana; font-size:9pt;" type="text" name="text_title" value="" size="15" maxlength="50"><input type="image" src="/wiki/img/moin-search.gif" name="button_title"  alt="[?]" hspace="3" width="12" height="12" border="0">, text search <input style="font-family:Verdana; font-size:9pt;" type="text" name="text_full" value="" size="15" maxlength="50"><input type="image" src="/wiki/img/moin-search.gif" name="button_full"  alt="[?]" hspace="3" width="12" height="12" border="0"> or an index<br>
Or try one of these actions: 
<a href="/x-wiki/DialogsAndTalks?action=LikePages">LikePages</a>, 
<a href="/x-wiki/DialogsAndTalks?action=LocalSiteMap">LocalSiteMap</a>, 
<a href="/x-wiki/DialogsAndTalks?action=SpellCheck">SpellCheck</a><br>

</td></tr>
</form>
</table>

<!-- MoinMoin 1.178 on tiger.gsc-game.kiev.ua served this page in 0.530 secs -->
</body></html>
